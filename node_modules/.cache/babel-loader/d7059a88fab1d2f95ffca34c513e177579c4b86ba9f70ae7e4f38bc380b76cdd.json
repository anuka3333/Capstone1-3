{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import api from'../api';import{useAuth0}from'@auth0/auth0-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AlbumForm=_ref=>{let{onAlbumCreated}=_ref;const[albumName,setAlbumName]=useState('');const[photos,setPhotos]=useState([]);const[previews,setPreviews]=useState([]);const[loading,setLoading]=useState(false);const[users,setUsers]=useState([]);const[clientId,setClientId]=useState('');const{getAccessTokenSilently}=useAuth0();// Fetch users for admin dropdown\nuseEffect(()=>{async function fetchUsers(){try{var _res;let token;try{// prefer audience when configured for Auth0 API\ntoken=await getAccessTokenSilently({audience:process.env.REACT_APP_AUTH0_AUDIENCE});}catch(tErr){// token may fail when audience isn't configured; keep going to try unauthenticated fetch for debugging\nconsole.warn('getAccessTokenSilently failed:',(tErr===null||tErr===void 0?void 0:tErr.message)||tErr);}let res;if(token){res=await api.get('/auth/users',{headers:{Authorization:`Bearer ${token}`}});}else{// fallback: try unauthenticated call (useful when backend route is public or for debugging path issues)\nconsole.warn('No token available — attempting unauthenticated request to /auth/users');res=await api.get('/auth/users');}console.log('users response:',(_res=res)===null||_res===void 0?void 0:_res.data);setUsers(res.data.users||res.data||[]);}catch(err){var _err$response;console.error('Failed to fetch users:',(err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message||err);}}fetchUsers();},[getAccessTokenSilently]);const handlePhotoChange=e=>{const files=Array.from(e.target.files);setPhotos(files);setPreviews(files.map(file=>URL.createObjectURL(file)));};const handleSubmit=async e=>{e.preventDefault();if(!albumName||photos.length===0||!clientId){alert('Please provide album name, select a client, and at least one photo.');return;}const formData=new FormData();formData.append('albumName',albumName);formData.append('clientId',clientId);photos.forEach(photo=>formData.append('photos',photo));try{setLoading(true);const token=await getAccessTokenSilently();const response=await api.post('/api/albums/create',formData,{headers:{'Content-Type':'multipart/form-data',Authorization:`Bearer ${token}`}});console.log('Album created:',response.data);onAlbumCreated();// refresh albums list\n// Reset form\nsetAlbumName('');setPhotos([]);setPreviews([]);setClientId('');}catch(error){console.error('Error creating album:',error);alert('Error creating album.');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px',border:'1px solid #ccc',padding:'15px',borderRadius:'8px'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Album\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'10px'},children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Select Client:\",/*#__PURE__*/_jsxs(\"select\",{value:clientId,onChange:e=>setClientId(e.target.value),required:true,style:{marginLeft:'10px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Select Client --\"}),users.map(user=>/*#__PURE__*/_jsxs(\"option\",{value:user.id,children:[user.name,\" (\",user.email,\")\"]},user.id))]})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Album Name:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:albumName,onChange:e=>setAlbumName(e.target.value),required:true,style:{marginLeft:'10px'}})]})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'10px'},children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Upload Photos:\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,accept:\"image/*\",onChange:handlePhotoChange,style:{marginLeft:'10px'}})]})}),previews.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'10px',display:'flex',gap:'10px',flexWrap:'wrap'},children:previews.map((url,index)=>/*#__PURE__*/_jsx(\"img\",{src:url,alt:`Preview ${index}`,style:{width:'100px',height:'100px',objectFit:'cover',borderRadius:'5px'}},index))}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{marginTop:'10px',padding:'6px 12px'},children:loading?'Uploading...':'Create Album'})]})]});};export default AlbumForm;","map":{"version":3,"names":["React","useState","useEffect","axios","api","useAuth0","jsx","_jsx","jsxs","_jsxs","AlbumForm","_ref","onAlbumCreated","albumName","setAlbumName","photos","setPhotos","previews","setPreviews","loading","setLoading","users","setUsers","clientId","setClientId","getAccessTokenSilently","fetchUsers","_res","token","audience","process","env","REACT_APP_AUTH0_AUDIENCE","tErr","console","warn","message","res","get","headers","Authorization","log","data","err","_err$response","error","response","handlePhotoChange","e","files","Array","from","target","map","file","URL","createObjectURL","handleSubmit","preventDefault","length","alert","formData","FormData","append","forEach","photo","post","style","marginTop","border","padding","borderRadius","children","onSubmit","marginBottom","value","onChange","required","marginLeft","user","id","name","email","type","multiple","accept","display","gap","flexWrap","url","index","src","alt","width","height","objectFit","disabled"],"sources":["/Users/anukherlen/capstone1-3/src/components/AlbumForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport api from '../api';\nimport { useAuth0 } from '@auth0/auth0-react';\n\nconst AlbumForm = ({ onAlbumCreated }) => {\n  const [albumName, setAlbumName] = useState('');\n  const [photos, setPhotos] = useState([]);\n  const [previews, setPreviews] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [users, setUsers] = useState([]);\n  const [clientId, setClientId] = useState('');\n\n  const { getAccessTokenSilently } = useAuth0();\n\n  // Fetch users for admin dropdown\n  useEffect(() => {\n    async function fetchUsers() {\n      try {\n        let token;\n        try {\n          // prefer audience when configured for Auth0 API\n          token = await getAccessTokenSilently({\n            audience: process.env.REACT_APP_AUTH0_AUDIENCE,\n          });\n        } catch (tErr) {\n          // token may fail when audience isn't configured; keep going to try unauthenticated fetch for debugging\n          console.warn('getAccessTokenSilently failed:', tErr?.message || tErr);\n        }\n\n        let res;\n        if (token) {\n          res = await api.get('/auth/users', {\n            headers: { Authorization: `Bearer ${token}` },\n          });\n        } else {\n          // fallback: try unauthenticated call (useful when backend route is public or for debugging path issues)\n          console.warn('No token available — attempting unauthenticated request to /auth/users');\n          res = await api.get('/auth/users');\n        }\n\n        console.log('users response:', res?.data);\n        setUsers(res.data.users || res.data || []);\n      } catch (err) {\n        console.error('Failed to fetch users:', err?.response?.data || err.message || err);\n      }\n    }\n    fetchUsers();\n  }, [getAccessTokenSilently]);\n\n  const handlePhotoChange = (e) => {\n    const files = Array.from(e.target.files);\n    setPhotos(files);\n    setPreviews(files.map((file) => URL.createObjectURL(file)));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!albumName || photos.length === 0 || !clientId) {\n      alert('Please provide album name, select a client, and at least one photo.');\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('albumName', albumName);\n    formData.append('clientId', clientId);\n    photos.forEach((photo) => formData.append('photos', photo));\n\n    try {\n      setLoading(true);\n      const token = await getAccessTokenSilently();\n      const response = await api.post('/api/albums/create', formData, {\n        headers: { 'Content-Type': 'multipart/form-data', Authorization: `Bearer ${token}` },\n      });\n      console.log('Album created:', response.data);\n      onAlbumCreated(); // refresh albums list\n\n      // Reset form\n      setAlbumName('');\n      setPhotos([]);\n      setPreviews([]);\n      setClientId('');\n    } catch (error) {\n      console.error('Error creating album:', error);\n      alert('Error creating album.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div style={{ marginTop: '20px', border: '1px solid #ccc', padding: '15px', borderRadius: '8px' }}>\n      <h2>Create New Album</h2>\n      <form onSubmit={handleSubmit}>\n        <div style={{ marginBottom: '10px' }}>\n          <label>\n            Select Client:\n            <select value={clientId} onChange={e => setClientId(e.target.value)} required style={{ marginLeft: '10px' }}>\n              <option value=\"\">-- Select Client --</option>\n              {users.map(user => (\n                <option key={user.id} value={user.id}>{user.name} ({user.email})</option>\n              ))}\n            </select>\n          </label>\n        </div>\n        <div>\n          <label>\n            Album Name:\n            <input\n              type=\"text\"\n              value={albumName}\n              onChange={(e) => setAlbumName(e.target.value)}\n              required\n              style={{ marginLeft: '10px' }}\n            />\n          </label>\n        </div>\n\n        <div style={{ marginTop: '10px' }}>\n          <label>\n            Upload Photos:\n            <input\n              type=\"file\"\n              multiple\n              accept=\"image/*\"\n              onChange={handlePhotoChange}\n              style={{ marginLeft: '10px' }}\n            />\n          </label>\n        </div>\n\n        {previews.length > 0 && (\n          <div style={{ marginTop: '10px', display: 'flex', gap: '10px', flexWrap: 'wrap' }}>\n            {previews.map((url, index) => (\n              <img key={index} src={url} alt={`Preview ${index}`} style={{ width: '100px', height: '100px', objectFit: 'cover', borderRadius: '5px' }} />\n            ))}\n          </div>\n        )}\n\n        <button type=\"submit\" disabled={loading} style={{ marginTop: '10px', padding: '6px 12px' }}>\n          {loading ? 'Uploading...' : 'Create Album'}\n        </button>\n      </form>\n    </div>\n  );\n};\n\nexport default AlbumForm;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}